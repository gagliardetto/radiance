package sbf

import (
	"testing"

	"github.com/stretchr/testify/require"
)

func TestEBPF(t *testing.T) {
	// /// let prog = &[
	// ///     0xb7, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	// ///     0x95, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
	// ///     ];
	// /// let insn = ebpf::get_insn(prog, 1);
	// /// assert_eq!(insn.opc, 0x95);

	prog := []byte{
		0xb7, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x95, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	}
	insn := GetInsn(prog, 1)
	require.Equal(t, uint8(0x95), insn.Opc)
}
